this is utility function.version3